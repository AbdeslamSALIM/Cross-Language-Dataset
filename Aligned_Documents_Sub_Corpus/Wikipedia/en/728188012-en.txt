In mathematics, the Euler–Maclaurin formula provides a powerful connection between integrals (see calculus) and sums. It can be used to approximate integrals by finite sums, or conversely to evaluate finite sums and infinite series using integrals and the machinery of calculus. The formula was discovered independently by Leonhard Euler and Colin Maclaurin around 1735 (and later generalized as Darboux's formula). Euler needed it to compute slowly converging infinite series while Maclaurin used it to calculate integrals.The formulaIf n'' is a natural number and ''f(x'') is a smooth (meaning: sufficiently often differentiable) function defined for all real numbers ''x between 0 and n, then the integralI=\int_0^n f(x)\,dxcan be approximated by the sum (or vice versa)S=\fracf(0)+f\left( 1\right) +\cdots+f\left( n-1\right) +\fracf(n) (see trapezoidal rule). The Euler–Maclaurin formula provides expressions for the difference between the sum and the integral in terms of the higher derivatives &fnof;(k'') at the end points of the interval 0 and ''n. Explicitly, for any natural number p, we haveS-I= \sum_^p\frac\left(f^(n)-f^(0)\right)+Rwhere B''1 = &minus;1/2, ''B2 = 1/6, B''3 = 0, ''B4 = &minus;1/30, B''5 = 0, ''B6 = 1/42, B''7 = 0, ''B8 = &minus;1/30, ... are the Bernoulli numbers, and R'' is an error term which is normally small for suitable values of ''p.Note that-B_1(f(n)+f(0)) =\frac(f(n)+f(0)).Hence, we may also write the formula as follows:\begin & \quad f(0)+f(1)+\dotsb+f(n-1)+f(n) \\ & = \int^n_0f(x)\,dx -B_1(f(n)+f(0))+\sum_^p\frac\left(f^(n)-f^(0)\right)+R. \end By using the substitution rule, one can adapt this formula also to functions &fnof; which are defined on some other interval of the real line.The remainder termThe remainder term R'' is most easily expressed using the periodic Bernoulli polynomials ''Pn''(''x). The Bernoulli polynomials B''''n(x''), ''n = 0,&nbsp;1,&nbsp;2,&nbsp;... are defined recursively asB_0(x) = 1, \,  B_n'(x) = nB_(x)\mbox\int_0^1 B_n(x)\,dx = 0\mboxn \ge 1. Then the periodic Bernoulli functions P''''n are defined as P_n(x) = B_n(x - \lfloor x\rfloor)\mbox0 where \scriptstyle \lfloor x\rfloor denotes the largest integer that is not greater than x''. Then, in terms of ''Pn''(''x), the remainder term R can be written as R = (-1)^ \int_0^n f^(x) (x) \over p!\,dx, The remainder term can be estimated as\left|R\right|\leq\frac\int_0^n\left|f^(x)\right|\,dx.ApplicationsThe Basel problemThe Basel problem asks to determine the sum 1 + \frac14 + \frac19 + \frac1 + \frac1 + \cdots = \sum_^\infty \frac. Euler computed this sum to 20 decimal places with only a few terms of the Euler–Maclaurin formula in 1735. This probably convinced him that the sum equals &pi;2 / 6, which he proved in the same year.David J. Pengelley, &quot;Dances between continuous and discrete: Euler's summation formula&quot;, in: Robert Bradley and Ed Sandifer (Eds), Proceedings, Euler 2K+2 Conference (Rumford, Maine, 2002) , Euler Society, 2003.Sums involving a polynomialIf f'' is a polynomial and ''p is big enough, then the remainder term vanishes. For instance, if f''(''x) = x''3, we can choose ''p = 2 to obtain after simplification\sum_^n i^3=\left(\frac\right)^2(see Faulhaber's formula).Numerical integrationThe Euler–Maclaurin formula is also used for detailed error analysis in numerical quadrature; in particular, extrapolation methods depend on it.Asymptotic expansion of sumsIn the context of computing asymptotic expansions of sums and series, usually the most useful form of the Euler–Maclaurin formula is\sum_^f(n) \sim \int_^ f(x)\,dx+\frac+\sum_^\,\frac\left(f^(b)-f^(a)\right)\, ,where a and b are integers. Often the expansion remains valid even after taking the limits  or , or both. In many cases the integral on the right-hand side can be evaluated in closed form in terms of elementary functions even though the sum on the left-hand side cannot. Then all the terms in the asymptotic series can be expressed in terms of elementary functions. For example,\sum_^\frac \sim \underbrace^\frac\,dk_+\frac+\sum_^\frac\, . Here the left-hand side is equal to (z), namely the first-order polygamma function defined through (z)=\frac\ln \Gamma(z); the gamma function  is equal to  if  is a positive integer. This results in an asymptotic expansion for (z). That expansion, in turn, serves as the starting point for one of the derivations of precise error estimates for Stirling's approximation of the factorial function.ProofsDerivation by mathematical inductionWe follow the argument given in (Apostol) Tom M. Apostol, "An Elementary View of Euler's Summation Formula", American Mathematical Monthly, volume 106, number 5, pages 409&mdash;418 (May 1999). ..The Bernoulli polynomials B''''n(x''), ''n = 0,&nbsp;1,&nbsp;2,&nbsp;... may be defined recursively as follows:B_0(x) = 1, \,  B_n'(x) = nB_(x)\mbox\int_0^1 B_n(x)\,dx = 0\mboxn \ge 1. The first several of these are B_1(x)=x-1/2, \quad B_2(x)=x^2-x+1/6,  B_3(x) = x^3-\fracx^2+\fracx, \quad B_4(x)=x^4-2x^3+x^2-\frac, \dots The values B''''n(1) are the Bernoulli numbers. Notice that for n&nbsp;&ge;&nbsp;2 we haveB_n(0) = B_n(1) = B_n\quad(:n\text). We define the periodic Bernoulli functions P''''n by P_n(x) = B_n(x - \lfloor x\rfloor)\mbox0 where  \lfloor x\rfloor denotes the largest integer that is not greater than x''. So ''Pn agree with the Bernoulli polynomials on the interval (0,&nbsp;1) and are periodic with period 1. Thus, P_n(0) = P_n(1)= B_n\quad \text n1.For n&nbsp;=&nbsp;1, P_1(0) = - P_n(1)=B_1.Now, consider the integral \int_k^ f(x)\,dx = \int u\,dv,where\beginu &= f(x), \\ du &= f'(x)\,dx, \\ v &= P_1(x),\\ dv &= P_0(x)\,dx \quad (\mboxP_0(x)=1). \\ \endIntegrating by parts, we get\begin\int_k^ f(x)\,dx &= uv - \int v\,du &\\ &= \Big\Big_k^ - \int_k^ f'(x)P_1(x)\,dx \\ \\ &=-B_1(f(k) + f(k+1)) - \int_k^ f'(x)P_1(x)\,dx. \end Summing the above from k'' = 0 to ''k = n &minus; 1, we get\begin &\int_0^ f(x)\,dx+\dotsb+\int_^ f(x)\,dx \\ &= \int_0^n f(x)\, dx \\ &= \frac+ f(1) + \dotsb + f(n-1) +  - \int_1^n f'(x) P_1(x)\,dx. \endAdding (&fnof;(0)&nbsp;+&nbsp;&fnof;(n))/2 to both sides and rearranging, we have \sum_^n f(k) = \int_0^n f(x)\,dx +  + \int_0^n f'(x) P_1(x)\,dx.\qquad (1)The last two terms therefore give the error when the integral is taken to approximate the sum.Next, consider \int_k^ f'(x)P_1(x)\,dx = \int u\,dv, where\beginu &= f'(x), \\ du &= f''(x)\,dx, \\ v &= P_2(x)/2\\ dv &= P_1(x)\,dx. \endIntegrating by parts again, we get,\beginuv - \int v\,du &= \left[  \right]_k^ - \int_k^ f''(x)P_2(x)\,dx \\ \\ &=  -\int_k^ f''(x)P_2(x)\,dx. \endThen summing from k'' = 0 to ''k = n &minus; 1, and then replacing the last integral in (1) with what we have thus shown to be equal to it, we have \sum_^n f(k) = \int_0^n f(x)\,dx +  + \frac(f'(n) - f'(0)) - \int_0^n f''(x)P_2(x)\,dx. By now the reader will have guessed that this process can be iterated. In this way we get a proof of the Euler–Maclaurin summation formula by mathematical induction, in which the induction step relies on integration by parts and on the identities for periodic Bernoulli functions.In order to get bounds on the size of the error when the sum is approximated by the integral, we note that the Bernoulli polynomials on the interval 0,&amp;nbsp;1 attain their maximum absolute values at the endpoints (see D.H. Lehmer in References below), and the value B''''n(1) is the ''n''th Bernoulli number.Derivation by functional analysisThe Euler–MacLaurin formula can be understood as a curious application of some ideas from Hilbert spaces and functional analysis.First we restrict to the domain of unit interval 0,1. Let B_n(x) be the Bernoulli polynomials. A set of functions dual to the Bernoulli polynomials are given by\tilde_n(x)=\frac \left[\delta^(1-x) - \delta^(x) \right]where &delta; is the Dirac delta function. The above is a formal notation for the idea of taking derivatives at a point; thus one has\int_0^1 \tilde_n(x) f(x)\, dx = \frac \left[f^(1) - f^(0) \right]for n'' &gt; 0 and some arbitrary but differentiable function ''f(x'') on the unit interval. For the case of ''n = 0, one defines \tilde_0(x)=1. The Bernoulli polynomials, along with their duals, form an orthogonal set of states on the unit interval: one has\int_0^1 \tilde_m(x) B_n(x)\, dx = \delta_and\sum_^\infty B_n(x) \tilde_n(y) = \delta (x-y).The Euler–MacLaurin summation formula then follows as an integral over the latter. One hasf(x)=\int_0^1 \sum_^\infty B_n(x) \tilde_n(y) f(y)\, dy=\int_0^1 f(y)\,dy +\sum_^ B_n(x) \frac \left[ f^(1) - f^(0) \right]\frac \int_0^1 B_(x-y) f^(y)\, dy.Then value x'' = 0 and rearranging terms, one obtains an expression for ''f(0). Note that the Bernoulli numbers are defined as B_n=B_n(0), and that these vanish for odd n greater than 1.Then, using the periodic Bernoulli function P''''n defined above and repeating the argument on the interval 1,2, one can obtain an expression of f(1). This way one can obtain expressions for f(n), n=0,1,2,...,N, and adding them up gives the Euler-MacLaurin formula. Note that this derivation does assume that f''(''x) is sufficiently differentiable and well-behaved; specifically, that f'' may be approximated by polynomials; equivalently, that ''f is a real analytic function.The Euler–MacLaurin summation formula can thus be seen to be an outcome of the representation of functions on the unit interval by the direct product of the Bernoulli polynomials and their duals. Note, however, that the representation is not complete on the set of square-integrable functions. The expansion in terms of the Bernoulli polynomials has a non-trivial kernel. In particular, sin(2&pi;nx) lies in the kernel; the integral of sin(2&pi;nx) is vanishing on the unit interval, as is the difference of its derivatives at the endpoints.NotesReferencesPierre Gaspard, "r-adic one-dimensional maps and the Euler summation formula", Journal of Physics A, 25 (letter) L483-L485 (1992). (Describes the eigenfunctions of the transfer operator for the Bernoulli map)Xavier Gourdon and Pascal Sebah, Introduction on Bernoulli's numbers, (2002)D.H. Lehmer, "On the Maxima and Minima of Bernoulli Polynomials", American Mathematical Monthly, volume 47, pages 533&ndash;538 (1940)Category:Approximation theory Category:Asymptotic analysis Category:Hilbert space Category:Numerical integration (quadrature) Category:Articles containing proofsde:Euler-Maclaurin-Formel es:Fórmula de Euler-Maclaurin fr:Formule d'Euler-Maclaurin it:Formula di Eulero-Maclaurin hu:Euler-Maclaurin képlet nl:Formule van Euler-Maclaurin ja:オイラーの和公式 pl:Wzór Eulera-Maclaurina