In mathematics, Wilson's theorem states that p  1 is a prime number if and only if(p-1)!\ \equiv\ -1\ (\mbox\ p)(see factorial and modular arithmetic for the notation).HistoryThe theorem was first discovered by the Iraqi mathematician Ibn al-Haytham (known as Alhazen in Medieval Europe) circa 1000 AD, but it is named after John Wilson (a student of the English mathematician Edward Waring) who stated it in the 18th century. Waring announced the theorem in 1770, although neither he nor Wilson could prove it. Lagrange gave the first proof in 1773.Joseph Louis Lagrange, "Demonstration d'un théorème nouveau concernant les nombres premiers," Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-Lettres de Berlin, vol. 2, pages 125-137 (1771). (Note: Lagrange proved Wilson's theorem in 1773. In 1773, when the Berlin Academy finally published its Mémoires for 1771, Lagrange's proof was simply inserted in the Mémoires for 1771. See footnote 2 on page 499 of: Leonard Euler; A. P. Juskevic and R. Taton (ed.s), Correspondence de Leonard Euler avec A. C. Clairaut, J. d'Alembert et J. L. Lagrange (Cambridge, Massachusetts: Birkhäuser, 1980) French.) There is evidence that Leibniz was also aware of the result a century earlier, but he never published it.ProofsFirst proofThis proof uses the fact that if p'' is a prime, then the set of numbers ''G = (Z'''/''pZ')&times; =  forms a group under [[Multiplicative group of integers modulo n|multiplication modulo ''p]]. This means that for each element a'' in ''G, there is a unique inverse element b'' in ''G such that ab ≡ 1 (mod p''). If ''a ≡ b'' (mod ''p), then a''2 ≡ 1 (mod ''p), which forces a''2 &minus; 1 = (''a + 1)(a'' &minus; 1) ≡ 0 (mod ''p), and since p'' is prime, this forces ''a ≡ 1 or &minus;1 (mod p''), i.e. ''a = 1 or a'' = ''p &minus; 1.In other words, 1 and p'' &minus; 1 are each their own inverse, but every other element of ''G has a distinct inverse, and so if we collect the elements of G'' pairwise in this fashion and multiply them all together, we get the product &minus;1. For example, if ''p = 11, we have10! = 1(10)(2 \cdot 6)(3 \cdot 4)(5 \cdot 9)(7 \cdot 8) \ \equiv\ -1\ (\mbox\ 11).\,The commutative and associative properties are used in above procedure. All elements in the above product will be of the form g&nbsp;g&nbsp;&minus;1 ≡ 1 (mod p'') except 1 (''p&nbsp;&minus;&nbsp;1) which is left.If p = 2, the result is trivial to check.For a converse (but see below for a more exact converse result), suppose the congruence holds for a composite n'', and note that then ''n has a proper divisor d'' with 1 g(x)=(x-1)(x-2) \cdots (x-(p-1)).\,Recall that if f''(''x) is a nonzero polynomial of degree d'' over a field ''F, then f''(''x) has at most d'' roots over ''F. Now, with g''(''x) as above, consider the polynomialf(x)=g(x)-(x^-1).\,Since the leading coefficients cancel, we see that f''(''x) is a polynomial of degree at most p'' &minus; 2. Reducing mod ''p, we see that f''(''x) has at most p'' &minus; 2 roots mod ''p. But by Fermat's little theorem, each of the elements 1, 2, ..., p'' &minus; 1 is a root of ''f(x''). This is impossible, unless ''f(x'') is identically zero mod ''p, i.e. unless each coefficient of f''(''x) is divisible by p.But since p'' is odd, the constant term of ''f(x'') is just (''p &minus; 1)! + 1, and the result follows.ApplicationsWilson's theorem is useless as a primality test in practice, since computing (n'' − 1)! modulo ''n for large n is hard, and far easier primality tests are known.Using Wilson's Theorem, we have for any prime p:1\cdot 2\cdots (p-1)\ \equiv\ -1\ (\mbox\ p)1\cdot(p-1)\cdot 2\cdot (p-2)\cdots m\cdot (p-m)\ \equiv\ 1\cdot (-1)\cdot 2\cdot (-2)\cdots m\cdot (-m)\ \equiv\ -1\ (\mbox\ p)where p'' = 2''m + 1. This becomes\prod_^m\ j^2\ \equiv(-1)^\ (\mbox\ p).And so primality is determined by the quadratic residues of p''. We can use this fact to prove part of a famous result: &minus;1 is a square (quadratic residue) mod ''p if p'' ≡ 1 (mod 4). For suppose ''p = 4''k'' + 1 for some integer k''. Then we can take ''m = 2''k'' above, and we conclude that\left( \prod_^\ j \right)^ = \prod_^\ j^2\ \equiv (-1)^\ = -1(\mbox\ p).Wilson's theorem has been used to construct formulas for primes, but they are too slow to have practical value.== Generalization ==There is also a generalization of Wilson's theorem, due to Carl Friedrich Gauss:\prod_ \!\!a \ \equiv \ \left \ -1\ (\mboxm) & \mbox m=4,\;p^\alpha,\;2p^\alpha \\ \ \ 1\ (\mboxm) & \mbox \end \right. where p'' is an odd prime. This further generalizes to the fact that in any finite abelian group, either the product of all elements is the identity, or there is precisely one element ''a of order 2. In the latter case, the product of all elements equals a.ConverseThe converse to Wilson's theorem states that for a composite number n  5,n'' divides (''n &minus; 1)!.This leaves the case n = 4, for which 3! is congruent to 2 modulo 4.In fact if q'' is a prime factor of ''n, so that n'' = ''qa, the numbers1, 2, ..., n &minus; 1include a'' &minus; 1 multiples of ''q. Therefore the power of q'' dividing the factorial is at least ''n/q &minus; 1; and the power dividing n at mostlog n''/log ''q.The required inequalitylog n''/log ''q &le; n/q &minus; 1does hold in general, except for the case q'' = 2 and ''n = 4.See alsoPrimitive root modulo nWilson primeNotesReferencesExternal linksCategory:Modular arithmetic Category:Prime numbers Category:Factorial and binomial topics Category:Mathematical theorems Category:Articles containing proofsbg:Теорема на Уилсън ca:Teorema de Wilson cs:Wilsonova věta da:Wilsons sætning de:Satz von Wilson es:Teorema de Wilson fr:Théorème de Wilson ko:윌슨의 정리 it:Teorema di Wilson lv:Vilsona teorēma hu:Wilson-tétel nl:Stelling van Wilson ja:ウィルソンの定理 pl:Twierdzenie Wilsona pt:Teorema de Wilson ro:Teorema lui Wilson ru:Теорема Вильсона fi:Wilsonin lause sv:Wilsons sats th:ทฤษฎีบทของวิลสัน vi:Định lý Wilson zh:威尔逊定理