   The Onion Router (Tor) (littéralement : le routage en oignon) est un réseau mondial décentralisé de routeurs, organisés en couches, appelés nœuds de l'oignon, dont la tâche est de transmettre de manière anonyme des paquets TCP. C'est ainsi que tout échange Internet basé sur TCP peut être anonymisé en utilisant Tor. Tor est un logiciel libre distribué sous licence BSD révisée.Le routage en oignon dans TorLe routage en oignon fut conçu à partir de l'appréciation des carences des systèmes pré-existants (notamment les serveurs mandataires) qui ne suffisent pas à garantir l'anonymat d'un individu.Tor est la seconde génération de système de routage en oignon (la première génération contenait beaucoup de défauts et n'a donc jamais eu de vrai succès).Vue d'ensembleLe routage en oignon utilise diverses techniques pour faire rebondir un échange TCP au sein d'Internet afin que des analyses de trafic sur une partie du réseau (notamment par attaque de l'homme du milieu) ne puissent pas identifier un utilisateur. Dans la suite de l'article, on suppose vouloir échanger un paquet entre un client et un serveur (voir Client-serveur).Construction d'un circuitAyant accès à la liste des nœuds de Tor, chaque client doit y choisir un chemin aléatoire (il pourra en changer au bout d'un certain intervalle de temps), puis construit un circuit au sein duquel chaque nœud a la propriété de connaître son prédécesseur et son successeur, sans en savoir plus.Cette construction fait appel au concept de cryptographie hybride. Chaque nœud d'oignon possède une clef publique, mais la cryptographie à clef secrète est bien plus rapide que celle à clef publique. L'idée est donc de distribuer à chaque nœud du circuit une clef secrète chiffrée avec leur clef publique.Après la phase de construction, chaque nœud du circuit a une clef secrète qui lui est propre et ne connaît que son prédécesseur et son successeur au sein du circuit.Échange de paquetsPour acheminer un paquet au serveur, le client doit chiffrer son paquet de nombreuses fois :la première fois, le client chiffre son paquet TCP avec la clef secrète correspondant au dernier nœud, numéroté n.la deuxième fois, avec celle de l'avant-dernier nœud, numérotée n-1.la troisième fois, avec celle de n-2.la quatrième fois, avec celle de n-3....la dernière fois, avec celle du premier nœud, numérotée 1.À ce stade, toutes les couches de l'oignon enferment le paquet TCP. Voyons comment est pelé l'oignon : lorsque le client envoie ce paquet au circuit qu'il a construit :le premier serveur du circuit déchiffre le paquet avec la clef 1 et l'envoie au deuxième serveur.le deuxième serveur déchiffre ce paquet avec la clef 2....le dernier serveur déchiffre ce paquet avec la clef n et obtient le paquet original.En pratique, un client du réseau Tor peut configurer son navigateur web pour utiliser un serveur mandataire personnel qui donne accès à Tor (comme Privoxy). Voici le déroulement d'une visite de Wikipédia par ce client :Son navigateur envoie la requête HTTP à Privoxy.Privoxy retranche l'information non anonyme, passe l'information via SOCKS au client Tor. Le client construit un circuit (si ce n'est déjà fait), chiffre les données à envoyer, et les passe au premier nœud.Ce premier nœud déchiffre une partie de l'enveloppe et fait suivre les données jusqu'à atteindre le nœud de sortie.Ce nœud de sortie envoie la requête à Wikipedia.La même chose se passe en sens inverse. L'échange est ainsi anonyme, mais est cependant très ralenti.Services cachésTor propose un ensemble de services cachés à ses utilisateurs, qui ont pour but de publier des sites web ou de proposer d'autres services sur internet en cachant l'identité du serveur qui les héberge. Ils permettent ainsi de cacher l'adresse IP, donc les coordonnées géographiques, de serveurs utilisant ce service caché.Pour la mise en place de sites web cachés, le serveur doit d'abord être configuré localement par son créateur, puis Tor va "pointer" sur ce serveur pour que des personnes extérieures puissent y accéder. Dans ce cas, le serveur recevra de Tor une adresse en .onion, et il ne pourra être accessible que par l'intermédiaire de Tor. L'accès d'utilisateurs à un service web protégé par les services cachés se fait selon un protocole défini par Tor. Ce protocole gère notamment la notion de "rendez-vous" entre l'utilisateur et le site web, ce rendez-vous ayant lieu sur un des nœuds du réseau Torhttps://svn.torproject.org/svn/tor/trunk/doc/design-paper/tor-design.pdf document de spécification de Tor.La principale critique faite aux services cachés est le temps qu'il faut pour charger les pages de sites utilisant les services cachés. La longueur de la connexion peut ainsi excéder plusieurs minutes. Il est donc actuellement impossible d'utiliser les services cachés de Tor afin de créer des pages web très interactives ou encore de mettre en place des messageries instantanées. De plus, l'enregistrement d'un serveur sur le réseau Tor prend lui aussi beaucoup de temps (définition de point d'introduction au serveur, définition des clés publiques et privées, construction des relais pour pointer sur le site). C'est pour améliorer ces défauts que Tor a lancé le NLnet Project qui vise à repenser la structure des services cachés et à rendre leur utilisation plus rapide. Ce projet est programmé pour aboutir en mai 2009.Un anonymat partielTor ne peut assurer la protection de paquets UDP, et n'en soutient donc pas les utilisations, notamment les requêtes aux serveurs DNS, pourtant nécessaires à la navigation web et extrêmement révélatrices des habitudes de navigation du client. Cependant Tor offre la possibilité de router les requêtes DNS à travers son réseau, notamment à l'aide de la commande "torify". Et les auteurs recommandent l'extension firefox "Torbutton" qui fait passer tout le trafic Firefox par Tor et non une partie configurée.Par ailleurs, tout site web peut disposer sur ses pages un applet Java qui lui renvoie l'adresse IP de ses clients, annulant ainsi l'efficacité de Tor, qui avait justement pris soin de masquer cette information. Il est difficile de se prémunir de cette parade, car bloquer l'exécution de ce type de code bloque également des fonctionnalités parfois indispensables aux services rendus par un site. On peut cependant utiliser NoScript, une extension Firefox qui gère les scripts java en les activant uniquement dans les domaines de confiance. Mais le mieux est de désactiver tous vos plug-ins (Java, Flash Player …).Attaque de type "Time Pattern" :Tor permet d'empêcher un attaquant de suivre le chemin pris par une connexion. Cependant, s'il ne peut reconnaître le contenu du flux, il existe des moyens dont le principe est en quelque sorte lié au problème des canaux cachés. Par exemple, envoyez un flux comme du code morse : 3 paquets envoyés en salve, puis 5 secondes de silence, puis 3 paquets, etc. Lorsque vous verrez un flux sortir d'un nœud Tor et dont le "motif temporel" ressemble à celui-ci, alors vous saurez que c'est le vôtre.Selon ce principe, vous pouvez chercher à attribuer une signature temporelle à un flux que vous essayez de suivre, ce qui vous permettra peut-être de le faire. Un attaquant peut d'ailleurs augmenter ses chances en donnant lui-même un motif temporel au flux qu'il cherche à suivre. C'est en effet chose possible. Comme au sein d'un nœud tous les paquets sont transférés par le biais d'une machine commune et se partagent donc les ressources du système, un attaquant peut inonder un nœud de ses propres paquets pour moduler un ralentissement de la machine comme il l'entend, et ainsi créer une signature temporelle pour les flux qui traversent ce nœud précis.Ces deux types d'attaques sont très différents et posent de nombreuses questions. La première montre que même si le réseau Tor protégeait parfaitement votre anonymat, des moyens simples peuvent le contourner complètement et fortement compromettre son efficacité. Le second exemple est plus destiné à montrer que bien que Tor reste un outil formidable, on peut l'attaquer directement, et il n'est donc pas un paradis pour hackers.PolémiqueL'existence d'un tel réseau est sujet à polémique : certains anonymats sont moins défendables que d'autres.Si la communauté Tor fait en effet valoir que les délinquants utilisent déjà d'autres techniques (vol, piratage, ingénierie sociale, etc.), et qu'en outre, pour certains échanges, la condition d'anonymat est primordiale : journalistes, réseaux militants, etc., il reste que l'on ne saurait ignorer le risque que des actes illicites soient, à l'aide de tor, commis sans qu'aucune archive ne permette d'identifier les éventuels auteurs d'infractions. (La police allemande a ainsi saisi, en septembre 2006, des serveurs du réseau Tor dans le cadre de l'instruction d'une affaire de pédophilie). On qualifie donc parfois ces systèmes de réseaux d'impunité, les nœuds étant localisés dans le monde entier, alors même qu'une législation à l'échelle d'un seul pays est déjà difficile à mettre en oeuvre.La liste des serveurs Tor étant connue (par nécessité et par volonté des responsables du logiciel), certains sites web et canaux IRC ont bloqué l'accès à leurs données par le réseau Tor.Autres réseaux d'''anonymisation''JAP : Java Anon ProxyFreenetGNUnet : échange de fichiers anonyme multi fonctions (multiplateforme)ANts P2P : échange de fichiers, anonymisation de serveur web http, et Chat (non anonymisé).MUTE : échange de fichiers.I2PMNameEntropyOmemoNotes et références http://www.torproject.org/download.html.fr#Warning : renforcer l'anonymat de TorLiens externesSite officiel[http://rebellyon.info/article2466.html Tor, article de rebellyon] (enrichi à partir de l'article de Framasoft) Statistiques sur le réseau Tor Weaknesses of TorCatégorie:Sécurité du réseau informatique Catégorie:Routeur Catégorie:Système informatique d'anonymat Catégorie:Logiciel librebg:Tor da:The Onion Router de:Tor (Netzwerk) el:Tor en:Tor (anonymity network) es:Tor fi:Tor (ohjelma) gl:Tor he:TOR hu:TOR it:Tor (software di anonimato) ja:Tor ko:토르 (네트워크) lo:ທໍ nl:Tor (netwerk) nn:The Onion Router no:The Onion Router pl:Tor (sieć anonimowa) pt:The Onion Router ru:Tor simple:Tor (software) sv:Tor (nätverk) th:ทอร์ vi:Tor zh:Tor